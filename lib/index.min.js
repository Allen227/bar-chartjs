!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).BarChart=n()}(this,function(){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function t(t){return function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s=["x","y","w","h"];var c={fontSize:13,fontFamily:"Arial",fontStyle:"#333",barStyle:"rgba(54, 162, 235, 0.6)",axisStyle:"#aaa",lineStyle:"#ccc",duration:2e3,data:[],labels:[]};function e(t){var n=t.context,e=t.tick,i=t.canvasW,o=t.canvasH,a=t.yAxis_left;!function(t,n,e,i){t.beginPath(),t.strokeStyle=c.axisStyle,t.moveTo(n,0),t.lineTo(n,i-20),t.closePath(),t.stroke()}(n,a,0,o),function(t,n,e,i){var o=c.labels,a=(e-n)/(o.length+1),r=i-26;t.beginPath();for(var s=1;s<=o.length;s++)t.moveTo(n+s*a,r),t.lineTo(n+s*a,6+r),t.fillStyle=c.fontStyle,t.textAlign="center",t.fillText(o[s-1],n+s*a,20+r);t.closePath(),t.stroke()}(n,a,i,o),function(t,n,e,i,o){var a=(o-40)/n[3],r=o-26;t.beginPath(),t.strokeStyle=c.lineStyle;for(var s=0;s<=n[3];s++)t.textBaseline="middle",t.textAlign="right",t.font="".concat(c.fontSize,"px ").concat(c.fontFamily),t.fillStyle=c.fontStyle,t.fillText(n[2]*s,e-10,r-s*a),t.moveTo(e-6,r-s*a),t.lineTo(e,r-s*a),t.moveTo(e,r-s*a),t.lineTo(i,r-s*a);t.closePath(),t.stroke()}(n,e,a,i,o)}var i={formatTick:function(){var f=[];return function(t,n,e){if(!arguments.length)return f;!function(t,n,e){var i,o,a,r,s=(n-t)/e,c=Math.log10(s);o=0<=(o=(s/(i=Math.pow(10,parseInt(c))===s?Math.pow(10,parseInt(c)):Math.pow(10,parseInt(c+1)))).toFixed(6))&&o<=.1?.1:.100001<=o&&o<=.2?.2:.200001<=o&&o<=.25?.25:.250001<=o&&o<=.5?.5:1,o*=i,parseInt(t/o)!==t/o&&(t=parseInt(t/o)*o),parseInt(n/o)!==n/o&&(n=(parseInt(n/o)+1)*o),(r=(n-t)/o)<e&&(n+=!(a=e-r)%2?o*parseInt(a/2):o*parseInt(a/2+1),t-=o*parseInt(a/2)),f.push([t,n,o,e])}(t,n,e)}},getSuitableStep:function(t,n){for(var e=this.formatTick(),i=10;5<=i;i--)e(t,n,i);var o,a=e(),r=Number.MAX_VALUE;return a.forEach(function(t,n){t[1]<=r&&(r=t[1],o=n)}),a[o]},getTick:function(t,n){return this.getSuitableStep(t,n)},requestAnimationFrame:function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}},o=0;function a(t){throw t}function r(t,n){this instanceof r||a(new Error('BarChart is constructor, should be involed with "new" operator!')),this._init(t,n)}return r.prototype._init=function(t,n){this.initContext(t),this.initOption(n),this.initAnimation(),this.initData(),this.caculateScele(),this.initBars(),this.render()},r.prototype.initData=function(){this.min_data=Math.min.apply(Math,t(c.data)),this.max_data=Math.max.apply(Math,t(c.data))},r.prototype.initAnimation=function(){this.requestAnimation=i.requestAnimationFrame()},r.prototype.initContext=function(t){t.nodeType===Node.ELEMENT_NODE&&"CANVAS"===t.nodeName?(this.canvasW=t.width,this.canvasH=t.height,this.context=t.getContext("2d")):a(new Error("Context should be a canvas DOM"))},r.prototype.initOption=function(e){null===e||Array.isArray(e)||"object"!==n(e)?a(new Error("Option should be a object-type")):Object.keys(c).forEach(function(t,n){e[t]&&(c[t]=e[t])})},r.prototype.initBars=function(){var i=this;this.bars=[];var o=this.areaW/(c.data.length+1)/2,a=1.5*o,r=(this.canvasH-40)/this.tick[1];c.data.forEach(function(t,n){var e=function(){var e=Object.create(null),i=arguments;return s.forEach(function(t,n){e[t]=i[n]}),e}(a+i.yAxis_left,i.canvasH-26,o,-1*t*r);i.bars.push(e),a+=2*o})},r.prototype.caculateScele=function(){this.tick=i.getTick(0<=this.min_data?0:this.min_data,this.max_data),this.context.font="".concat(c.fontSize," ").concat(c.fontFamily),this.yAxis_left=parseInt(2*this.context.measureText(this.tick[1]).width),this.areaW=this.canvasW-this.yAxis_left},r.prototype.render=function(){this.context.translate(.5,.5),e(this),this.animation()},r.prototype.drawBars=function(){var n=this;this.context.fillStyle=c.barStyle,this.bars.forEach(function(t){!function(t,n){t.fillRect(n.x,n.y,n.w,n.h)}(n.context,t)})},r.prototype.animation=function(){var t=this.context;if(t.clearRect(0,0,this.canvasW,this.canvasH),t.save(),e(this),o-=10,t.rect(0,this.canvasH,this.canvasW,o),t.clip(),this.drawBars(),o>-1*this.canvasH){var n=this.animation.bind(this);i.requestAnimationFrame()(n)}t.restore()},r});